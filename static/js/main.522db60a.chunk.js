(this["webpackJsonpdash-web"]=this["webpackJsonpdash-web"]||[]).push([[0],{238:function(e,t,n){},294:function(e,t){},296:function(e,t){},328:function(e,t){},330:function(e,t){},370:function(e,t,n){},371:function(e,t,n){},392:function(e,t,n){},400:function(e,t,n){},401:function(e,t,n){},402:function(e,t,n){},518:function(e,t,n){},519:function(e,t,n){},520:function(e,t,n){},521:function(e,t,n){},523:function(e,t,n){},524:function(e,t,n){"use strict";n.r(t);var c=n(33),a=n(50),i=n(63),r=n(11),o=n(6),s=n(0),d=n(45),l=n(539),u=n(528),b=n(545),j=n(540),h=n(541),f=n(542),O=n(543),m=(n(238),n(526)),v=n(527),p=n(24),g=n.n(p),x={"Content-type":"application/json"};var w=n(1);function k(e){var t=Object(s.useState)(e.tab.label),n=Object(o.a)(t,2),c=n[0],a=n[1],i=Object(s.useState)(!1),r=Object(o.a)(i,2),d=r[0],l=r[1];return Object(w.jsx)(m.a,{className:"clickableItem",children:Object(w.jsx)(v.a,{onClick:e.onTabClicked,children:d?Object(w.jsxs)("div",{className:"flexRow",children:[Object(w.jsx)("input",{onDoubleClick:function(){(function(e,t,n){return g.a.post("".concat("https://dash-webservices.herokuapp.com","/tab/updateTab"),{id:e,label:t,tabOrder:n},{headers:x})})(e.tab.id,c,e.tab.tabOrder).then((function(){l(!d)}))},onChange:function(e){return a(e.target.value)},value:c}),Object(w.jsx)(u.a,{className:"deleteTabButton",onClick:function(){var t;(t=e.tab.id,g.a.delete("".concat("https://dash-webservices.herokuapp.com","/tab/deleteTab/?id=").concat(t),{headers:x})).then((function(){return e.onTabDeleted(e.tab.id)}))},children:Object(w.jsx)("i",{className:"fa fa-trash"})})]}):Object(w.jsx)("span",{onDoubleClick:function(){l(!d)},children:c})})},e.tab.id)}var y,S=n(529),C=n(530),D=n(531),N=n(532),E=n(533),_=n(534);!function(e){e[e.WEATHER=1]="WEATHER",e[e.RSS=2]="RSS",e[e.CALENDAR=3]="CALENDAR",e[e.STRAVA=4]="STRAVA"}(y||(y={}));var R=function(e){return Object(w.jsx)("div",{className:"flexRow",children:Object.keys(y).map((function(t){return isNaN(parseInt(t,0))&&Object(w.jsxs)(S.a,{children:[Object(w.jsx)(C.a,{top:!0,width:"100%",src:"/assets/318x180.svg",alt:"Card image cap"}),Object(w.jsxs)(D.a,{children:[Object(w.jsx)(N.a,{children:t}),Object(w.jsxs)(E.a,{children:["Widget ",t]}),Object(w.jsxs)(_.a,{children:["Cliquez ci-dessous pour ajouter un widget ",t," au dashboard."]}),Object(w.jsx)(u.a,{id:t,onClick:e.onWidgetAdded,className:"btn btn-success",value:y[t],children:"Ajouter"})]})]},t)}))})},T="TOGGLE_TAB",I=function(e){return{type:T,payload:{id:e}}},L={"Content-type":"application/json"};function A(e,t){return g.a.post("".concat("https://dash-webservices.herokuapp.com","/widget/updateWidgetData"),{id:e,data:t},{headers:L})}var B,M=n(538),W=n(64),z=W.createLogger({format:W.format.combine(W.format.json(),W.format.colorize({all:!0})),level:"debug",transports:[new W.transports.Console]}),F=n(18),H=n(222),P=n.n(H),V=n(223);function U(e){return Object(w.jsxs)("div",{children:[Object(w.jsx)("h4",{children:"\xcates-vous s\xfbr de vouloir supprimer ce widget ?"}),Object(w.jsx)("button",{onClick:e.onCancelButtonClicked,className:"btn btn-primary cancelButton",children:"Annuler"}),Object(w.jsx)("button",{onClick:function(){e.onDeleteButtonClicked(e.idWidget)},className:"btn btn-danger validateDeletionButton",children:"Supprimer"})]})}function K(e){var t=Object(s.useState)(B.READ),n=Object(o.a)(t,2),c=n[0],a=n[1];return Object(s.useEffect)((function(){a(B.READ)}),[e.config]),Object(w.jsx)("div",{children:c===B.READ?Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{className:"header",children:[Object(w.jsx)("div",{className:"leftGroup widgetHeader",children:e.header}),Object(w.jsxs)("div",{className:"rightGroup",children:[Object(w.jsx)("button",{onClick:function(){a(B.EDIT)},className:"btn btn-default editButton",children:Object(w.jsx)("i",{className:"fa fa-cog","aria-hidden":"true"})}),Object(w.jsx)("button",{onClick:e.refreshFunction,className:"btn btn-default refreshButton",children:Object(w.jsx)("i",{className:"fa fa-refresh","aria-hidden":"true"})}),Object(w.jsx)("button",{onClick:function(){a(B.DELETE)},className:"btn btn-default deleteButton",children:Object(w.jsx)("i",{className:"fa fa-trash","aria-hidden":"true"})})]})]}),e.body]}):c===B.DELETE?Object(w.jsx)(U,{idWidget:e.id,onDeleteButtonClicked:e.onDeleteButtonClicked,onCancelButtonClicked:function(){a(B.READ)}}):e.editModeComponent})}!function(e){e[e.READ=1]="READ",e[e.EDIT=2]="EDIT",e[e.DELETE=3]="DELETE"}(B||(B={}));n(370),n(371);function Y(e){var t=Object(s.useState)(e.calendarUrls||[]),n=Object(o.a)(t,2),c=n[0],a=n[1],i=function(e){a(c.map((function(t,n){var c;return n.toString()===(null===(c=e.target)||void 0===c?void 0:c.id)?e.target.value:t})))};return Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{children:[c&&c.map((function(e,t){return Object(w.jsx)("input",{id:t.toString(),onChange:i,value:e,placeholder:"Saisissez une URL"},t)})),Object(w.jsx)("button",{className:"btn btn-success",onClick:function(){a(c.concat(""))},children:"Ajouter"})]}),Object(w.jsx)("button",{onClick:function(){e.onConfigSubmitted(c)},disabled:!c||(null===c||void 0===c?void 0:c.length)<1,className:"btn btn-success",children:"Valider"})]})}function q(e){var t,n,c=Object(s.useState)(e.calendars),a=Object(o.a)(c,2),i=a[0],r=a[1],d=Object(s.useState)([]),l=Object(o.a)(d,2),u=l[0],b=l[1],j=Object(s.useState)([]),h=Object(o.a)(j,2),f=h[0],O=h[1],m=Object(s.useState)("week"),v=Object(o.a)(m,2),p=v[0],x=v[1],k=s.useRef(null);function y(){b([]),O([]),null===i||void 0===i||i.map((function(e,t){g.a.get("".concat("https://dash-webservices.herokuapp.com","/proxy/?url=").concat(e)).then((function(n){var c,a,i=t.toString(),r={id:i,name:e.substring(0,10),color:"blue",borderColor:"blue"},o=t>0?u:[];(b([].concat(Object(F.a)(o),[r])),"month"!==(null===(c=k.current)||void 0===c?void 0:c.getInstance().getViewName()))&&(null===(a=k.current)||void 0===a||a.getInstance().scrollToNow());var s=V.parseICS(n.data),d=t>0?f:[];O([].concat(Object(F.a)(d),Object(F.a)(Object.keys(s).map((function(e){if(Object.prototype.hasOwnProperty.call(s,"eventKey")&&"VEVENT"===s[e].type){var t,n,c,a,r=s[e];return{calendarId:i,title:r.summary,start:null===(t=r.start)||void 0===t?void 0:t.toISOString(),end:null===(n=r.end)||void 0===n?void 0:n.toISOString(),location:r.location,category:0===(null===(c=r.end)||void 0===c?void 0:c.getHours())&&0===(null===(a=r.start)||void 0===a?void 0:a.getHours())?"allday":"time"}}return{}})))))})).catch((function(e){z.error(e)}))}))}Object(s.useEffect)((function(){y()}),[i]),Object(s.useEffect)((function(){var e;null===(e=k.current)||void 0===e||e.getInstance().scrollToNow()}),[u]);var S=Object(w.jsx)("div",{children:"Calendar"}),C=Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{id:"calendarMenu",children:[Object(w.jsxs)("span",{id:"menu-navi",children:[Object(w.jsx)("button",{onClick:function(){k&&k.current&&k.current.getInstance().today()},className:"btn btn-default btn-sm move-today","data-action":"move-today",children:"Today"}),Object(w.jsx)("button",{onClick:function(){k&&k.current&&k.current.getInstance().prev()},className:"btn btn-default btn-sm move-day","data-action":"move-prev",children:Object(w.jsx)("i",{className:"tui-full-calendar-icon tui-full-calendar-ic-arrow-left","data-action":"move-prev"})}),Object(w.jsx)("button",{onClick:function(){k&&k.current&&k.current.getInstance().next()},className:"btn btn-default btn-sm move-day","data-action":"move-next",children:Object(w.jsx)("i",{className:"tui-full-calendar-icon tui-full-calendar-ic-arrow-right","data-action":"move-next"})})]}),Object(w.jsxs)("span",{id:"renderRange",className:"render-range",children:[null===(t=k.current)||void 0===t?void 0:t.getInstance().getDateRangeStart().toDate().toLocaleDateString("fr"),"-"," ",null===(n=k.current)||void 0===n?void 0:n.getInstance().getDateRangeEnd().toDate().toLocaleDateString("fr")]}),Object(w.jsx)("button",{onClick:function(){x("day")},className:"btn btn-".concat("day"===p?"primary":"default"),children:"Jour"}),Object(w.jsx)("button",{onClick:function(){x("week")},className:"btn btn-".concat("week"===p?"primary":"default"),children:"Semaine"}),Object(w.jsx)("button",{onClick:function(){x("month")},className:"btn btn-".concat("month"===p?"primary":"default"),children:"Mois"})]}),Object(w.jsx)(P.a,{ref:k,height:"inherit",calendars:u,disableDblClick:!0,disableClick:!1,isReadOnly:!1,month:{startDayOfWeek:1,daynames:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]},schedules:f,scheduleView:!0,taskView:!0,template:{milestone:function(e){return'<span style="color:#fff;background-color: '.concat(e.bgColor,';">').concat(e.title,"</span>")},milestoneTitle:function(){return"Milestone"},allday:function(e){return"".concat(e.title,'<i class="fa fa-refresh"></i>')},alldayTitle:function(){return"All Day"}},useDetailPopup:!0,useCreationPopup:!0,view:p,defaultView:"week",week:{startDayOfWeek:1,hourStart:8,daynames:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],showTimezoneCollapseButton:!0,timezonesCollapsed:!0}})]});return Object(w.jsx)("div",{children:Object(w.jsx)(K,{id:e.id,tabId:e.tabId,config:{calendarUrls:i},header:S,body:C,editModeComponent:Object(w.jsx)(Y,{calendarUrls:i,onConfigSubmitted:function(t){A(e.id,{calendars:t}).then((function(){r(t)})).catch((function(e){z.error(e.message)}))}}),refreshFunction:y,onDeleteButtonClicked:e.onDeleteButtonClicked})})}var J=n(225),G=n.n(J),Q=n(535);n(392);function $(e){var t=Object(s.useState)(!1),n=Object(o.a)(t,2),c=n[0],a=n[1];return Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{onClick:function(){a(!c)},className:"title",children:e.componentRoot}),Object(w.jsx)("div",{children:Object(w.jsx)(Q.a,{isOpen:c,children:Object(w.jsx)(S.a,{children:Object(w.jsx)(D.a,{children:e.componentDetail})})})})]})}n(226);function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Date(1e3*e+1e3*t)}function Z(e){var t=-60*(new Date).getTimezoneOffset();if(Math.abs(e)===Math.abs(t))return 0;var n=Math.abs(e)+Math.abs(t);return e<t?-n:n}n(400);function ee(e){var t=document.createElement("div");return t.innerHTML=e||"",t.textContent||t.innerText||""}var te=function(e){return Object(w.jsxs)("div",{className:"article",children:[Object(w.jsx)("div",{children:Object(w.jsx)("a",{href:e.link,children:e.title})}),Object(w.jsx)("div",{children:ee(e.content)||ee(e.description)}),Object(w.jsxs)("div",{children:["Publi\xe9 le ",(t=e.pubDate||"",new Date(t).toLocaleString("fr"))," ",e.author&&"par "+e.author]})]});var t};n(401);function ne(e){var t=Object(s.useState)(e.url),n=Object(o.a)(t,2),c=n[0],a=n[1];return Object(w.jsxs)("div",{children:[Object(w.jsx)("input",{name:"url",onChange:function(e){return a(e.target.value)},value:c,placeholder:"Saisissez l'URL du flux RSS"}),Object(w.jsx)("button",{onClick:function(){c&&e.onUrlSubmitted(c)},disabled:!c||(null===c||void 0===c?void 0:c.length)<1,className:"btn btn-success",children:"Valider"})]})}n(402);function ce(e){var t=Object(s.useState)([]),n=Object(o.a)(t,2),c=n[0],a=n[1],i=Object(s.useState)(e.url),d=Object(o.a)(i,2),l=d[0],u=d[1],b=Object(s.useState)(""),j=Object(o.a)(b,2),h=j[0],f=j[1],O=Object(s.useState)(),m=Object(o.a)(O,2),v=m[0],p=m[1],g=Object(s.useState)(""),x=Object(o.a)(g,2),k=x[0],y=x[1],S=Object(s.useState)(""),C=Object(o.a)(S,2),D=C[0],N=C[1],E=new G.a;function _(){l&&E.parseURL("".concat("https://dash-webservices.herokuapp.com","/proxy/?url=").concat(l)).then((function(e){var t=e;f(t.description),a(t.items),p(t.image),y(t.link),N(t.title)})).catch((function(e){z.error(e.message)}))}function R(){a([]),_()}function T(e,t){var n=e?new Date(e).toLocaleTimeString("fr",{hour:"2-digit",minute:"2-digit"}):"";return"".concat(n," ").concat(t)}Object(s.useEffect)((function(){_()}),[l]);var I,L=Object(w.jsx)("div",{className:"rssWidgetTitle",children:Object(w.jsxs)("a",{href:k,className:"flexRow",children:[v&&Object(w.jsx)("div",{children:Object(w.jsx)("img",{className:"imgLogoRSS",src:null===v||void 0===v?void 0:v.url,alt:"logo"})}),Object(w.jsx)("div",{className:"rssTitle",children:D})]})}),B=Object(w.jsx)("div",{children:l&&c&&Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"rssDescription",children:h}),Object(w.jsx)("div",{className:"feed",children:(I=c,I.map((function(e){return Object(w.jsx)($,{componentRoot:T(e.pubDate,e.title),componentDetail:Object(w.jsx)(te,Object(r.a)({},e)),link:e.link},e.guid)})))})]})});return Object(w.jsx)("div",{children:Object(w.jsx)(K,{id:e.id,tabId:e.tabId,config:{url:l},header:L,body:B,editModeComponent:Object(w.jsx)(ne,{url:l,onUrlSubmitted:function(t){A(e.id,{url:t}).then((function(){u(t),R()})).catch((function(e){z.error(e.message)}))}}),refreshFunction:R,onDeleteButtonClicked:e.onDeleteButtonClicked})})}var ae=n(227),ie=n(20);function re(e,t){var n=Object(s.useState)((function(){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(c){return z.error(c),t}})),c=Object(o.a)(n,2),a=c[0],i=c[1];return[a,function(t){try{var n=t instanceof Function?t(a):t;i(n),window.localStorage.setItem(e,JSON.stringify(n))}catch(c){z.error(c)}}]}var oe=n(544);function se(e){return Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{children:Object(w.jsxs)("a",{href:"https://www.strava.com/activities/".concat(e.id),children:[Object(oe.a)(new Date(e.start_date_local),"dd MMM")," ",e.name]})}),Object(w.jsxs)("div",{children:["Distance : ",Math.round(1e3*e.distance)/1e6," kms"]}),Object(w.jsxs)("div",{children:["Dur\xe9e : ",e.moving_time/60," mins"]}),Object(w.jsxs)("div",{children:["Denivel\xe9 : ",e.total_elevation_gain]}),Object(w.jsxs)("div",{children:["Troph\xe9es : ",e.achievement_count]}),Object(w.jsxs)("div",{children:["Vitesse moyenne : ",e.average_speed]}),Object(w.jsxs)("div",{children:["Vitesse max : ",e.max_speed]}),Object(w.jsxs)("div",{children:["Kudos : ",e.kudos_count]}),Object(w.jsxs)("div",{children:["Commentaires : ",e.comment_count]})]})}function de(e){var t=Object(s.useState)(e.clientId||""),n=Object(o.a)(t,2),c=n[0],a=n[1],i=Object(s.useState)(e.clientSecret||""),r=Object(o.a)(i,2),d=r[0],l=r[1];return Object(w.jsxs)("div",{children:[Object(w.jsx)("input",{name:"clientId",onChange:function(e){return a(e.target.value)},value:c,placeholder:"Saisissez le clientId"}),Object(w.jsx)("input",{name:"clientSecret",onChange:function(e){return l(e.target.value)},value:d,placeholder:"Saisissez le clientSecret"}),Object(w.jsx)("button",{onClick:function(){e.onConfigSubmitted(c,d)},disabled:!c||(null===c||void 0===c?void 0:c.length)<1||!d||(null===d||void 0===d?void 0:d.length)<1,className:"btn btn-success",children:"Valider"})]})}var le=n(536),ue=n(537),be=n(90);function je(e){var t=Object(s.useState)(e.clientId),n=Object(o.a)(t,2),c=n[0],a=n[1],i=Object(s.useState)(e.clientSecret),d=Object(o.a)(i,2),l=d[0],b=d[1],j=Object(s.useState)([]),h=Object(o.a)(j,2),f=h[0],O=h[1],m=Object(s.useState)(),v=Object(o.a)(m,2),p=v[0],x=v[1],k=re("strava_token",null),y=Object(o.a)(k,2),S=y[0],C=y[1],D=re("strava_refresh_token",null),N=Object(o.a)(D,2),E=N[0],_=N[1],R=re("strava_token_expires_at",null),T=Object(o.a)(R,2),I=T[0],L=T[1],B=Object(ie.e)().search;function M(){O([]),S&&g.a.get("https://www.strava.com/api/v3/athlete",{headers:{Authorization:"Bearer ".concat(S)}}).then((function(e){x(e.data)})).catch((function(e){z.error(e.message)})),S&&I&&Object(ue.a)(new Date(1e3*I),new Date)?g.a.get("https://www.strava.com/api/v3/athlete/activities?page=1&per_page=".concat(20),{headers:{Authorization:"Bearer ".concat(S)}}).then((function(e){O(e.data.reverse())})).catch((function(e){z.error(e.message)})):W()}function W(){E?g.a.post("https://www.strava.com/oauth/token",{client_id:c,client_secret:l,refresh_token:E,grant_type:"refresh_token"}).then((function(e){C(e.data.access_token),_(e.data.refresh_token),L(e.data.expires_at),x(e.data.athlete)})).catch((function(e){z.error(e.message)})):z.error("No refresh token")}function F(){return f.reduce((function(e,t){var n=Object(oe.a)(new Date(t.start_date_local),"yyyy-MM");return e[n]||(e[n]=[]),e[n].push(Math.round(1e3*t.distance)/1e6),e}),[])}function H(){var e=F();return Object.keys(e).map((function(t){return{x:new Date(t),y:Math.round(e[t].reduce((function(e,t){return e+t})))}}))}Object(s.useEffect)((function(){var e=ae.parse(B);e&&e.code&&function(e){g.a.post("https://www.strava.com/oauth/token",{client_id:c,client_secret:l,code:e,grant_type:"authorization_code"}).then((function(e){C(e.data.access_token),_(e.data.refresh_token),L(e.data.expires_at),x(e.data.athlete)})).catch((function(e){z.error(e.message)}))}(e.code.toString());S&&E&&!Object(le.a)(new Date(1e3*I),new Date)||W()}),[]),Object(s.useEffect)((function(){S&&M()}),[S]);var P=Object(w.jsx)("div",{children:Object(w.jsxs)("a",{href:"https://www.strava.com/athletes/".concat(null===p||void 0===p?void 0:p.id),children:[Object(w.jsx)("img",{src:null===p||void 0===p?void 0:p.profile_medium}),null===p||void 0===p?void 0:p.firstname," ",null===p||void 0===p?void 0:p.lastname]})}),V=Object(w.jsxs)("div",{className:"flexColumn",children:[Object(w.jsx)("div",{style:{flex:"1 0 50%",overflowY:"scroll"},children:f.slice().reverse().map((function(e){return Object(w.jsx)($,{componentRoot:"".concat(Object(oe.a)(new Date(e.start_date_local),"dd MMM"),"  ").concat(e.name,"  ").concat(Math.round(1e3*e.distance)/1e6," kms"),componentDetail:Object(w.jsx)(se,Object(r.a)({},e)),link:"https://www.strava.com/activities/".concat(e.id)},e.id)}))}),Object(w.jsx)("div",{style:{minHeight:"25vh",flex:"1 0 50%"},children:Object(w.jsx)(be.a,{type:"bar",data:{labels:H().map((function(e){return Object(oe.a)(e.x,"MMM yyyy")})),datasets:[{label:"Activit\xe9s",backgroundColor:"darkgreen",data:Object.keys(F()).map((function(e){return{x:new Date(e),y:F()[e].length}}))},{label:"Course",backgroundColor:"orange",data:H()}]}})}),(!S||!E||I&&Object(le.a)(new Date(I),new Date))&&Object(w.jsx)("a",{href:"https://www.strava.com/oauth/authorize?client_id=".concat(c,"&redirect_uri=").concat("https://arnaudflaesch.github.io/Dash-Web/","&response_type=code&scope=read,activity:read"),children:Object(w.jsx)(u.a,{children:"Se connecter"})})]});return Object(w.jsx)("div",{children:Object(w.jsx)(K,{id:e.id,tabId:e.tabId,config:{clientId:c},header:P,body:V,editModeComponent:Object(w.jsx)(de,{clientId:c,clientSecret:l,onConfigSubmitted:function(t,n){A(e.id,{clientId:t,clientSecret:n}).then((function(){a(c),b(l),M()})).catch((function(e){z.error(e.message)}))}}),refreshFunction:M,onDeleteButtonClicked:e.onDeleteButtonClicked})})}n(518);function he(e){var t=Object(s.useState)(e.city||""),n=Object(o.a)(t,2),c=n[0],a=n[1],i=Object(s.useState)(e.weather_api_key||""),r=Object(o.a)(i,2),d=r[0],l=r[1];return Object(w.jsxs)("div",{children:[Object(w.jsx)("input",{name:"weatherApiKey",onChange:function(e){e.target.value&&l(e.target.value)},value:d,placeholder:"Saisissez la cl\xe9 d'API"}),Object(w.jsx)("input",{name:"city",onChange:function(e){return a(e.target.value)},value:c,placeholder:"Saisissez de nom de la ville"}),Object(w.jsx)("button",{className:"validateButton btn btn-success",onClick:function(){e.onConfigSubmitted(d,c)},disabled:!c||!d||(null===c||void 0===c?void 0:c.length)<1||(null===d||void 0===d?void 0:d.length)<1,children:"Valider"})]})}n(519);var fe,Oe=function(e){var t,n,c;return Object(w.jsxs)("div",{className:"forecast",children:[Object(w.jsx)("div",{children:X(e.dt,Z(e.city.timezone)).toLocaleString("fr",{weekday:"short",day:"numeric",hour:"2-digit"})}),Object(w.jsxs)("div",{className:"flexRow",children:[Object(w.jsx)("div",{children:Object(w.jsx)("img",{src:"https://openweathermap.org/img/wn/".concat(null===(t=e.weather[0])||void 0===t?void 0:t.icon,"@2x.png"),className:"smallImage",title:null===(n=e.weather[0])||void 0===n?void 0:n.description,alt:null===(c=e.weather[0])||void 0===c?void 0:c.description})}),Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("i",{className:"fa fa-thermometer-three-quarters fa-sm mr10",style:{color:"crimson"}}),e.main.temp_max,"\xb0"]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("i",{className:"fa fa-thermometer-quarter fa-sm mr10",style:{color:"blue"}}),e.main.temp_min,"\xb0"]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("i",{className:"fa fa-tint fa-sm mr10",style:{color:"lightblue"}}),e.main.humidity,"%"]})]})]})]})};n(520);function me(e){var t="http://api.openweathermap.org/data/2.5/",n="?units=metric&lang=fr&appid=",c=Object(s.useState)(e.city),a=Object(o.a)(c,2),i=a[0],d=a[1],l=Object(s.useState)(e.weather_api_key),u=Object(o.a)(l,2),b=u[0],j=u[1],h=Object(s.useState)(),f=Object(o.a)(h,2),O=f[0],m=f[1],v=Object(s.useState)(),p=Object(o.a)(v,2),x=p[0],k=p[1],y=Object(s.useState)(),S=Object(o.a)(y,2),C=S[0],D=S[1],N=Object(s.useState)(fe.TODAY),E=Object(o.a)(N,2),_=E[0],R=E[1];function T(){b&&i&&(g.a.get("".concat("https://dash-webservices.herokuapp.com","/proxy/"),{params:{url:"".concat(t).concat("weather").concat(n).concat(b,"&q=").concat(i)}}).then((function(e){m(e.data)})).catch((function(e){z.error(e)})),g.a.get("".concat("https://dash-webservices.herokuapp.com","/proxy/"),{params:{url:"".concat(t).concat("forecast").concat(n).concat(b,"&q=").concat(i)}}).then((function(e){k(e.data.list),D(e.data.city)})).catch((function(e){z.error(e.message)})))}function I(){m(void 0),k(void 0),D(void 0),T()}function L(){if(!C||!x)return[];switch(_){case fe.WEEK:return x.filter((function(e){return 17===X(e.dt,Z(C.timezone)).getHours()}));case fe.TOMORROW:return x.filter((function(e){return new Date(1e3*e.dt).getDay()===(new Date).getDay()+1}));case fe.TODAY:default:return x.filter((function(e){return new Date(1e3*e.dt).getDay()===(new Date).getDay()}))}}Object(s.useEffect)((function(){T()}),[i,b]);var B=Object(w.jsxs)("div",{children:["La m\xe9t\xe9o aujourd'hui \xe0 ",null===C||void 0===C?void 0:C.name]}),M=Object(w.jsxs)("div",{children:[C&&O&&O.weather&&Object(w.jsxs)("div",{className:"flexRow",children:[Object(w.jsx)("div",{children:Object(w.jsx)("img",{style:{width:"80px"},src:"https://openweathermap.org/img/wn/".concat(O.weather[0].icon,"@2x.png"),title:O.weather[0].description,alt:O.weather[0].description})}),Object(w.jsxs)("div",{className:"flexRow",style:{placeItems:"center"},children:[Object(w.jsxs)("div",{className:"flexColumn mr5",children:[Object(w.jsx)("div",{children:O.weather[0].description}),Object(w.jsxs)("div",{children:[Object(w.jsx)("i",{className:"fa fa-thermometer-three-quarters fa-md"})," ",O.main.temp,"\xb0"]})]}),Object(w.jsxs)("div",{className:"flexColumn",children:[Object(w.jsxs)("div",{className:"spaceBetween",children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("i",{className:"fa fa-sun-o fa-md"})," ",X(O.sys.sunrise,Z(O.timezone)).toLocaleTimeString("fr")]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("i",{className:"fa fa-moon-o fa-md"})," ",X(O.sys.sunset,Z(O.timezone)).toLocaleTimeString("fr")]})]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("i",{className:"fa fa-clock-o fa-md"})," ",X(O.dt,Z(O.timezone)).toLocaleString("fr")]})]})]})]}),C&&x&&Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{className:"flexRow",children:[Object(w.jsx)("span",{className:"bold",children:"Pr\xe9visions"}),Object(w.jsxs)("span",{style:{alignContent:"space-between",display:"flex"},children:[Object(w.jsx)("button",{onClick:function(){R(fe.TODAY)},style:{flex:"1"},className:"btn btn-".concat(_===fe.TODAY?"success":"primary"," mr-5"),children:"Aujourd'hui"}),Object(w.jsx)("button",{onClick:function(){R(fe.TOMORROW)},style:{flex:"1"},className:"btn btn-".concat(_===fe.TOMORROW?"success":"primary"),children:"Demain"}),Object(w.jsx)("button",{onClick:function(){R(fe.WEEK)},style:{flex:"1"},className:"btn btn-".concat(_===fe.WEEK?"success":"primary"),children:"Semaine"})]})]}),Object(w.jsx)("br",{}),Object(w.jsx)("div",{style:{height:"20vh",maxWidth:"100%"},children:Object(w.jsx)(be.b,{type:"line",data:{labels:L().map((function(e){return _===fe.TODAY||_===fe.TOMORROW?Object(oe.a)(new Date(1e3*e.dt),"HH"):Object(oe.a)(new Date(1e3*e.dt),"dd MMM")})),datasets:[{label:"Temp\xe9rature",borderColor:"orange",data:L().map((function(e){return e.main.temp_max}))},{label:"Ressenti",borderColor:"red",data:L().map((function(e){return e.main.feels_like}))}]},options:{maintainAspectRatio:!1}})}),Object(w.jsx)("div",{className:"flexRow forecastRow",children:C&&x&&L().map((function(e){return Object(w.jsx)("div",{className:"forecastContainer",children:Object(w.jsx)(Oe,Object(r.a)(Object(r.a)({},e),{},{city:C}))},e.dt)}))})]})]});return Object(w.jsx)("div",{children:Object(w.jsx)(K,{id:e.id,tabId:e.tabId,config:{city:C,apiKey:b},header:B,body:M,editModeComponent:Object(w.jsx)(he,{city:i,weather_api_key:b,onConfigSubmitted:function(t,n){A(e.id,{city:n,weather_api_key:t}).then((function(){d(n),j(t),I()})).catch((function(e){z.error(e.message)}))}}),refreshFunction:I,onDeleteButtonClicked:e.onDeleteButtonClicked})})}!function(e){e[e.TODAY=0]="TODAY",e[e.TOMORROW=1]="TOMORROW",e[e.WEEK=2]="WEEK"}(fe||(fe={}));var ve=n(8),pe=n(9),ge=n(17),xe=n(16),we=(n(521),function(e){return Object(w.jsx)("div",{children:Object(w.jsx)(i.a,{children:Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"tabContainer",children:e.tabList.map((function(e){return Object(w.jsx)("div",{children:Object(w.jsx)(i.b,{to:e.path,children:e.title})},e.title)}))}),Object(w.jsx)("div",{children:e.tabList.map((function(e){return Object(w.jsx)("div",{children:Object(w.jsx)(ie.a,{path:e.path,exact:e.exact,component:e.component})},e.title)}))})]})})})});var ke=[{title:"Groupes",component:function(){return Object(s.useEffect)((function(){new Promise((function(e,t){z.debug("getGroupsData"),FB.api("/me/groups",{fields:"administrator,bookmark_order,id,unread,cover,created_time,description,icon,email,link,name,purpose,venue,picture"},(function(n){n?e(n):t(Error("Promise rejected"))}))})).then((function(e){z.debug(e)})).catch((function(e){z.debug(e)}))}),[]),Object(w.jsx)("div",{children:"Liste des groupes auxquels vous appartenez"})},path:"/groups/"},{title:"Events",component:function(){return Object(s.useEffect)((function(){z.debug("onComponentDidMount")})),Object(w.jsx)("div",{children:"Liste des prochains \xe9v\xe8nements"})},path:"/events/"}],ye=function(e){Object(ge.a)(n,e);var t=Object(xe.a)(n);function n(e){var c;return Object(ve.a)(this,n),(c=t.call(this,e)).checkLoginStatus=function(){FB.getLoginStatus(c.facebookLoginHandler)},c.facebookLogin=function(){z.debug("facebookLogin"),FB.getLoginStatus((function(e){z.debug(e),c.setState({loginStatusResponse:e}),"connected"!==e.status&&FB.login(c.facebookLoginHandler,{scope:"user_birthday,user_hometown,user_likes,user_photos,user_friends,user_status,user_tagged_places,user_posts,user_gender,user_link,email,public_profile"})}))},c.facebookLogout=function(){FB.logout((function(e){z.debug(e),c.setState({userData:void 0,loginStatusResponse:e})}))},c.facebookLoginHandler=function(e){z.debug("facebookLoginHandler"),c.setState({loginStatusResponse:e}),"connected"===e.status&&(z.debug("Connected"),new Promise((function(e,t){z.debug("getProfile"),FB.api("/me",{fields:"id,first_name,last_name,hometown,location,birthday,gender,link"},(function(n){n?e(n):t(Error("Promise rejected"))}))})).then((function(e){z.debug("Result"),z.debug(e),c.setState({userData:e})})).catch((function(e){z.debug(e)})))},window.fbAsyncInit=function(){FB.init({appId:e.appId,xfbml:!0,version:"v3.2"});var t=new Event("FBObjectReady");document.dispatchEvent(t)},function(e,t,n){var c=e.getElementsByTagName(t)[0],a=e.getElementsByTagName(t)[0];e.getElementById(n)||((c=e.createElement(t)).id=n,c.src="https://connect.facebook.net/en_US/sdk.js",a&&a.parentNode&&a.parentNode.insertBefore(c,a))}(document,"script","facebook-jssdk"),document.addEventListener("FBObjectReady",c.checkLoginStatus),c}return Object(pe.a)(n,[{key:"componentWillUnmount",value:function(){document.removeEventListener("FBObjectReady",this.checkLoginStatus)}},{key:"render",value:function(){var e=null;if(this.state&&this.state.loginStatusResponse&&"connected"===this.state.loginStatusResponse.status&&this.state.userData){var t=this.state.userData;e=Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{children:[t.first_name," ",t.last_name]}),Object(w.jsx)("div",{onClick:this.facebookLogout,children:"Se d\xe9connecter"})]})}else e=Object(w.jsx)("div",{onClick:this.facebookLogin,className:"fb-login-button","data-max-rows":"1","data-size":"large","data-button-type":"continue_with","data-use-continue-as":"true"});return Object(w.jsxs)("div",{children:[e,this.state&&this.state.userData&&Object(w.jsx)("div",{children:Object(w.jsx)(we,{tabList:ke})})]})}}]),n}(s.Component);function Se(e){var t=Object(s.useState)([]),n=Object(o.a)(t,2),c=n[0],i=n[1],l=Object(a.c)((function(e){return e.activeTab}));function u(e){switch(e.type){case y.WEATHER:return Object(w.jsx)(me,Object(r.a)(Object(r.a)({id:e.id,tabId:e.tab.id},e.data),{},{onDeleteButtonClicked:b}));case y.RSS:return Object(w.jsx)(ce,Object(r.a)(Object(r.a)({id:e.id,tabId:e.tab.id},e.data),{},{onDeleteButtonClicked:b}));case y.CALENDAR:return Object(w.jsx)(q,Object(r.a)(Object(r.a)({id:e.id,tabId:e.tab.id},e.data),{},{onDeleteButtonClicked:b}));case y.STRAVA:return Object(w.jsx)(je,Object(r.a)(Object(r.a)({id:e.id,tabId:e.tab.id},e.data),{},{onDeleteButtonClicked:b}));default:return}}function b(e){(function(e){return g.a.delete("".concat("https://dash-webservices.herokuapp.com","/widget/deleteWidget/?id=").concat(e),{headers:L})})(e).then((function(t){t&&i(c.filter((function(t){return t.id!==e})))})).catch((function(e){z.error(e.message)}))}return Object(s.useEffect)((function(){c.length||l!==e.tabId||fetch("".concat("https://dash-webservices.herokuapp.com","/widget/?tabId=").concat(e.tabId)).then((function(e){return e.json()})).then((function(e){i(e)})).catch((function(e){z.error(e.message)}))}),[l]),Object(s.useEffect)((function(){e.newWidget&&i(c.concat([e.newWidget]))}),[null!=e.newWidget&&e.newWidget.id]),Object(w.jsx)(M.a,{tabId:e.tabId,children:Object(w.jsx)(d.a,{onDragEnd:function(e){e.destination&&function(e){var t=e.map((function(e){return{id:e.id,widgetOrder:e.widgetOrder}}));return g.a.post("".concat("https://dash-webservices.herokuapp.com","/widget/updateWidgetsOrder"),t,{headers:L})}(function(e,t,n){var c=Array.from(e),a=c.splice(t,1),i=Object(o.a)(a,1)[0];return c.splice(n,0,i),c}(c,e.source.index,e.destination.index).map((function(e,t){return e.widgetOrder=t,e}))).then((function(e){return i(e.data)}))},children:Object(w.jsx)(d.c,{droppableId:"droppable",children:function(e){return Object(w.jsx)("div",Object(r.a)(Object(r.a)({},e.droppableProps),{},{ref:e.innerRef,children:Object(w.jsxs)("div",{className:"widgetList",children:[Object(w.jsx)(ye,{}),c&&c.length>0&&c.map((function(e,t){return Object(w.jsx)(d.b,{draggableId:e.id.toString(),index:t,children:function(t){return Object(w.jsx)("div",Object(r.a)(Object(r.a)(Object(r.a)({className:"widget",ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{children:u(e)}),e.id)}},e.id)})),e.placeholder]})}))}})})})}function Ce(){var e=Object(s.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(s.useState)(),m=Object(o.a)(i,2),v=m[0],p=m[1],y=Object(s.useState)(!1),S=Object(o.a)(y,2),C=S[0],D=S[1],N=Object(a.c)((function(e){return e.activeTab})),E=Object(a.b)();function _(){var e;(e="Nouvel onglet",g.a.post("".concat("https://dash-webservices.herokuapp.com","/tab/addTab"),{label:e},{headers:x})).then((function(e){var t=e.data;c(n.concat(t)),E(I(t.id))}))}function T(){D(!C)}function A(e){c(n.filter((function(t){return t.id!==e}))),N===e&&E(I(n[0].id))}return Object(s.useEffect)((function(){fetch("".concat("https://dash-webservices.herokuapp.com","/tab/")).then((function(e){return e.json()})).then((function(e){e&&0!==e.length||_(),c(e),E(I(e[0].id))})).catch((function(e){z.error(e.message)}))}),[]),Object(w.jsx)("div",{className:"dash",children:Object(w.jsxs)("div",{className:"flexRow",children:[Object(w.jsx)("div",{className:"dashNavbar",children:Object(w.jsxs)(l.a,{vertical:!0,navbar:!0,children:[Object(w.jsx)(u.a,{id:"openAddWidgetModal",className:"dashNavbarLink",onClick:T,children:Object(w.jsx)("i",{className:"fa fa-plus-circle fa-lg","aria-hidden":"true"})}),Object(w.jsxs)(b.a,{isOpen:C,toggle:T,children:[Object(w.jsx)(j.a,{toggle:T,children:"Ajouter un widget"}),Object(w.jsx)(h.a,{children:Object(w.jsx)(R,{onWidgetAdded:function(e){N&&function(e,t){return g.a.post("".concat("https://dash-webservices.herokuapp.com","/widget/addWidget"),{type:e,tab:{id:t}},{headers:L})}(e.currentTarget.value,N).then((function(e){if(e){var t=e.data;p(t)}})).catch((function(e){z.error(e.message)}))}})}),Object(w.jsx)(f.a,{children:Object(w.jsx)(u.a,{id:"closeAddWidgetModal",color:"primary",onClick:T,children:"Fermer"})})]})]})}),Object(w.jsxs)("div",{className:"flexColumn tabsBar",children:[Object(w.jsxs)(l.a,{tabs:!0,children:[Object(w.jsx)(d.a,{onDragEnd:function(e){e.destination&&function(e){return g.a.post("".concat("https://dash-webservices.herokuapp.com","/tab/updateTabs"),e,{headers:x})}(function(e,t,n){var c=Array.from(e),a=c.splice(t,1),i=Object(o.a)(a,1)[0];return c.splice(n,0,i),c}(n,e.source.index,e.destination.index).map((function(e,t){return e.tabOrder=t,e}))).then((function(e){c(e.data)}))},children:Object(w.jsx)(d.c,{droppableId:"droppable",direction:"horizontal",children:function(e){return Object(w.jsxs)("div",Object(r.a)(Object(r.a)({className:"flexRow"},e.droppableProps),{},{ref:e.innerRef,children:[n.length>0&&n.map((function(e,t){return Object(w.jsx)(d.b,{draggableId:e.id.toString(),index:t,children:function(t){return Object(w.jsx)("div",Object(r.a)(Object(r.a)(Object(r.a)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{className:"tab ".concat(e.id===N?"selectedItem":""),children:Object(w.jsx)(k,{tab:e,onTabClicked:function(){return function(e){N!==e&&E(I(e))}(e.id)},onTabDeleted:A})}),e.id)}},e.id)})),e.placeholder]}))}})}),Object(w.jsx)(u.a,{onClick:_,id:"addNewTabButton",className:"fa fa-plus-circle fa-lg"})]}),Object(w.jsx)(O.a,{activeTab:N,children:n.length>0&&n.map((function(e){return Object(w.jsx)(Se,{newWidget:(t=e.id,v&&t===v.tab.id?v:void 0),tabId:e.id},e.id);var t}))})]})]})})}n(523);var De=n(37),Ne={activeTab:-1},Ee=Object(De.d)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case T:var n=t.payload.id;return Object(r.a)(Object(r.a)({},e),{},{activeTab:n});default:return e}})),_e=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Re(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.render(Object(w.jsx)(a.a,{store:Ee,children:Object(w.jsx)(i.a,{children:Object(w.jsx)(Ce,{})})}),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");_e?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Re(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Re(e)}))}}()}},[[524,1,2]]]);
//# sourceMappingURL=main.522db60a.chunk.js.map